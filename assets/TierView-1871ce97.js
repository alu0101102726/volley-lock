import{S as E}from"./sortable.esm-9c3c89c5.js";import{_ as B,P as T,h as S,R as m,b as $,a as h,d as g,i as x,u as N,j as R,U,m as C,r as V,o as u,c as f,e as y,t as k,F as L,k as M,l as j,f as q}from"./index-1a19c482.js";function A(r){let a=r,l=new Date,o=a.getTime()-l.getTime();if(o<=0)clearInterval(timer);else{var e=Math.floor(o/1e3),s=Math.floor(e/60),n=Math.floor(s/60),t=Math.floor(n/24);n%=24,s%=60,e%=60,document.querySelector("#days").textContent=t,document.querySelector("#hours").textContent=n,document.querySelector("#minutes").textContent=s,document.querySelector("#seconds").textContent=e}}const d=T(),F={data(){return{listName:"Volley Lock",images:[],loading:!1,voted:!1,registration:!1,votation:!1,jsonConfig:{},timer:null}},methods:{async getImages(){const r=await S(),a=m(h(d,"users"),$("email","not-in",[r.email,"voleylock@gmail.com"]));(await g(a)).forEach((o,e)=>{this.images.push({src:o.data().photo,alt:o.data().name,list:0})})},async sendInformation(){this.loading=!0;const r=await S(),a=x(d,"users",r.uid).withConverter(N),l=m(h(d,"votes")),e=(await g(l)).docs[0].data(),s=new Date(e.endDate.toDate()),n=x(d,"votes",`${s.getDate()}-${s.getMonth()+1}-${s.getFullYear()}`),t=await R(a),D=document.querySelectorAll(".list-group");let _={};D.forEach((c,w)=>{const I=c.querySelector(".level").value,b=c.querySelector(".sort").childNodes;for(let p=0;p<b.length;p++){let v=b[p],i=0;switch(I){case"S":i=6;break;case"A":i=5;break;case"B":i=4;break;case"C":i=3;break;case"D":i=2;break;case"E":i=1;break}e.votes[`${v.alt}`]?e.votes[`${v.alt}`]+=i:e.votes[`${v.alt}`]=i,_[`${v.alt}`]=i}}),t.data().voted?this.$swal("Ya has votado!","","info"):this.$swal({title:"¿Seguro que quieres registrar los datos?",text:"Una vez mandado no podrás volver a votar",icon:"warning",showCancelButton:!0}).then(c=>{if(c.isConfirmed){const w=new U(t.data().id,t.data().name,t.data().email,t.data().photo,!0,_);console.log(n,e),t.exists()&&(C(a,w),C(n,e),this.voted=!0),this.$swal("Enviado!","","success")}else this.$swal("Puedes seguir editando!","","info")}),this.loading=!1}},async mounted(){const r=m(h(d,"config")),a=await g(r);this.jsonConfig=a.docs[0].data();const l=new Date,o=new Date(this.jsonConfig.votesDateStart);if(l>o){this.registration=!1,this.votation=!0;let e=document.getElementsByClassName("sort");Array.from(e).forEach(s=>{new E(s,{group:"shared",animation:500})}),this.getImages()}this.timer=setInterval(function(){A(o)},1e3)},beforeUnmount(){this.timer&&clearTimeout(this.timer)}},P={key:0,class:"tier-list"},z=q('<div class="list-group row" data-v-0e7526f7><input type="text" value="S" class="tier6 level" readonly data-v-0e7526f7><div class="tier label6 sort ui-sortable" data-v-0e7526f7></div></div><div class="list-group row" data-v-0e7526f7><input type="text" value="A" class="tier5 level" readonly data-v-0e7526f7><div class="tier label5 sort ui-sortable" data-v-0e7526f7></div></div><div class="list-group row" data-v-0e7526f7><input type="text" value="B" class="tier4 level" readonly data-v-0e7526f7><div class="tier label4 sort ui-sortable" data-v-0e7526f7></div></div><div class="list-group row" data-v-0e7526f7><input type="text" value="C" class="tier3 level" readonly data-v-0e7526f7><div class="tier label3 sort ui-sortable" data-v-0e7526f7></div></div><div class="list-group row" data-v-0e7526f7><input type="text" value="D" class="tier2 level" readonly data-v-0e7526f7><div class="tier label2 sort ui-sortable" data-v-0e7526f7></div></div><div class="list-group row last" data-v-0e7526f7><input type="text" value="E" class="tier1 level" readonly data-v-0e7526f7><div class="tier label1 sort ui-sortable" data-v-0e7526f7></div></div>',6),Y={id:"char4 row",class:"sort ui-sortable",style:{"padding-top":"25px"}},G=["id","alt","src"],H={key:1,class:"registration"},J=q('<h2 data-v-0e7526f7>La votación comienza en:</h2><div id="timer" data-v-0e7526f7><span id="days" data-v-0e7526f7></span>días <span id="hours" data-v-0e7526f7></span>horas <span id="minutes" data-v-0e7526f7></span>minutos <span id="seconds" data-v-0e7526f7></span>segundos </div>',2);function K(r,a,l,o,e,s){const n=V("Button");return!e.voted&&e.votation?(u(),f("div",P,[y("h1",null,"TIER LIST - "+k(e.listName),1),z,y("div",Y,[(u(!0),f(L,null,M(e.images,t=>(u(),f("img",{class:"profile",key:t.alt,id:t.alt,alt:t.alt,src:t.src},null,8,G))),128))]),j(n,{style:{backgroundColor:"var(pink-200)"},type:"button",label:"Enviar Resultados",icon:"pi pi-check",loading:e.loading,onClick:a[0]||(a[0]=t=>s.sendInformation())},null,8,["loading"])])):(u(),f("div",H,[y("h1",null,"TIER LIST - "+k(e.listName),1),J]))}const W=B(F,[["render",K],["__scopeId","data-v-0e7526f7"]]);export{W as default};
