import{S as E}from"./sortable.esm-9c3c89c5.js";import{_ as B,P as $,h as S,R as h,b as N,a as m,d as g,i as k,u as R,j as T,U,m as x,k as V,r as L,o as u,c as p,e as f,t as D,F as j,l as A,n as F,f as C}from"./index-900782b8.js";const l=$(),P={data(){return{listName:"Volley Lock",images:[],loading:!1,voted:!1,registration:!1,votation:!1,jsonConfig:{},timer:null}},methods:{async getImages(){const r=await S(),a=h(m(l,"users"),N("email","not-in",[r.email,"voleylock@gmail.com"]));(await g(a)).forEach((o,t)=>{this.images.push({src:o.data().photo,alt:o.data().name,list:0})})},async sendInformation(){this.loading=!0;const r=await S(),a=k(l,"users",r.uid).withConverter(R),n=h(m(l,"votes")),t=(await g(n)).docs[0].data(),i=new Date(t.endDate.toDate()),d=k(l,"votes",`${i.getDate()}-${i.getMonth()+1}-${i.getFullYear()}`),e=await T(a),q=document.querySelectorAll(".list-group");let y={};q.forEach((c,_)=>{const I=c.querySelector(".level").value,w=c.querySelector(".sort").childNodes;for(let b=0;b<w.length;b++){let v=w[b],s=0;switch(I){case"S":s=6;break;case"A":s=5;break;case"B":s=4;break;case"C":s=3;break;case"D":s=2;break;case"E":s=1;break}t.votes[`${v.alt}`]?t.votes[`${v.alt}`]+=s:t.votes[`${v.alt}`]=s,y[`${v.alt}`]=s}}),e.data().voted?this.$swal("Ya has votado!","","info"):this.$swal({title:"¿Seguro que quieres registrar los datos?",text:"Una vez mandado no podrás volver a votar",icon:"warning",showCancelButton:!0}).then(c=>{if(c.isConfirmed){const _=new U(e.data().id,e.data().name,e.data().email,e.data().photo,!0,y);console.log(d,t),e.exists()&&(x(a,_),x(d,t),this.voted=!0),this.$swal("Enviado!","","success")}else this.$swal("Puedes seguir editando!","","info")}),this.loading=!1}},async mounted(){const r=h(m(l,"config")),a=await g(r);this.jsonConfig=a.docs[0].data();const n=new Date,o=new Date(this.jsonConfig.votesDateStart);if(n>o){this.registration=!1,this.votation=!0;let t=document.getElementsByClassName("sort");Array.from(t).forEach(i=>{new E(i,{group:"shared",animation:500})}),this.getImages()}this.timer=setInterval(function(){V(o)},1e3)},beforeUnmount(){this.timer&&clearTimeout(this.timer)}},z={key:0,class:"tier-list"},Y=C('<div class="list-group row" data-v-66549b87><input type="text" value="S" class="tier6 level" readonly data-v-66549b87><div class="tier label6 sort ui-sortable" data-v-66549b87></div></div><div class="list-group row" data-v-66549b87><input type="text" value="A" class="tier5 level" readonly data-v-66549b87><div class="tier label5 sort ui-sortable" data-v-66549b87></div></div><div class="list-group row" data-v-66549b87><input type="text" value="B" class="tier4 level" readonly data-v-66549b87><div class="tier label4 sort ui-sortable" data-v-66549b87></div></div><div class="list-group row" data-v-66549b87><input type="text" value="C" class="tier3 level" readonly data-v-66549b87><div class="tier label3 sort ui-sortable" data-v-66549b87></div></div><div class="list-group row" data-v-66549b87><input type="text" value="D" class="tier2 level" readonly data-v-66549b87><div class="tier label2 sort ui-sortable" data-v-66549b87></div></div><div class="list-group row last" data-v-66549b87><input type="text" value="E" class="tier1 level" readonly data-v-66549b87><div class="tier label1 sort ui-sortable" data-v-66549b87></div></div>',6),M={id:"char4 row",class:"sort ui-sortable",style:{"padding-top":"25px"}},G=["id","alt","src"],H={key:1,class:"registration"},J=C('<h2 data-v-66549b87>La votación comienza en:</h2><div id="timer" data-v-66549b87><span id="days" data-v-66549b87></span>días <br data-v-66549b87><span id="hours" data-v-66549b87></span>horas <br data-v-66549b87><span id="minutes" data-v-66549b87></span>minutos <br data-v-66549b87><span id="seconds" data-v-66549b87></span>segundos <br data-v-66549b87></div>',2);function K(r,a,n,o,t,i){const d=L("Button");return!t.voted&&t.votation?(u(),p("div",z,[f("h1",null,"TIER LIST - "+D(t.listName),1),Y,f("div",M,[(u(!0),p(j,null,A(t.images,e=>(u(),p("img",{class:"profile",key:e.alt,id:e.alt,alt:e.alt,src:e.src},null,8,G))),128))]),F(d,{style:{backgroundColor:"var(pink-200)"},type:"button",label:"Enviar Resultados",icon:"pi pi-check",loading:t.loading,onClick:a[0]||(a[0]=e=>i.sendInformation())},null,8,["loading"])])):(u(),p("div",H,[f("h1",null,"TIER LIST - "+D(t.listName),1),J]))}const W=B(P,[["render",K],["__scopeId","data-v-66549b87"]]);export{W as default};
